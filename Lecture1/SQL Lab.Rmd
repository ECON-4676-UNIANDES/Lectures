---
title: 'SQL lab'
output:
  html_document:
    # css: "files/main_style.css"
    mathjax: default
    fig_height: 4
    fig_width: 6
    highlight: tango
---

Hello! So you want to learn how to use SQL. In this Lab you will learn the intricacies and specifics of working with SQL, as well as common commands ued in SQL.

# What is SQL?:

First of all, SQL stands for Structured Query Language. SQL is used to interact with databases in many ways, and common uses are updating, moving, and retrieving data from a database of your choice. While many databases do use SQL, some add extra functionality through extensions. After this lab you should be able to interact with a database of your choice and begin to understand how to add functionality with extensions.

![](index.png)


## How to use SQL?

There are six main commands that are used in SQL. They are Create, Insert, Delete, Select, Update, Drop, and ALTER. With these six commands you can accomplish most if not all of your database related needs. 

To get started in SQL follow the information at this link: 
https://docs.microsoft.com/en-us/sql/database-engine/install-windows/install-sql-server?view=sql-server-2017

And get your free server here: 
https://www.microsoft.com/en-us/sql-server/sql-server-2017



# Table Basics:

## What is a Table?:

A Table in SQL is part of an Database. A table is similar to any other table you have used in many other areas of your life. Just a simple x by y grid with column and row headers. Simply having a table is not what makes SQL powerful, but how you can interact with one. As you can see below, this is a an example of a table that you can make in SQL.

![](temporal02.png)

## Interacting with a Table:

There are many ways to interact with a table in SQL. As mentioned before there are six main commands, here we will dive deeper into what these commands actually do.

Lets start with Create.

### Creating a Table:

Here is the create command: 

    CREATE TABLE "Table_name" ("Col_name1" data_type, "Col_name2" data_type);

As you can see it is very simple. The text in quotations refer to parts of the table where you should be assigning identifying names too. This command that is shown up above will create a table that is named "Table_Name" with two columns named "Col_name1" and "Col_name2". 

These columns will both hold values of type data_type. There are many different data types you can assign to a column. Some examples or INTEGER, TEXT, BOOLEAN, TIME, DATE, and DECIMAL to name a few. We commonly want to input a string as the type. There are multiple types of strings including char, nchar, varchar, and nvarchar. One very important prefix to any piece of data is PRIMARY KEY. The PRIMARY KEY prefix just signals to the data that the value with PRIMARY KEY in front of it is a unique row identifier, no other row should have the same PRIMARY KEY as any other row, and there can be atmost one PRIMARY KEY for each table. In the example table above, EmployeeID would be a primary key.

Sometimes you may want to ensure that the data in a column has a value to it. If you had a database of customers, perhaps you would want to require that all customers have a name in your table. You can do this by adding NOT NULL after the data_type for the column when creating the table.

### Inserting into a Table:

Now that we know how to create a data table, let us delve into how to insert records into a table. This is performed by using the INSERT INTO command:

    INSERT INTO "Table_name" ("Col_name1", "Col_name2", "Col_name3")
    VALUES ('Value_1', 'Value_2', 'Value_3');

What this command is doing currently is inserting VALUES into the table "Table_name". Because we specified which columns we would like to insert into ("Col_name1", "Col_name2", "Col_name3") as well as the data we would like to insert ('Value_1', 'Value_2', 'Value_3') a new record is created inside the table with the associated values. You can treat this version of the INSERT INTO command as just creating a new record. Even if there are more columns in the table, the example command above will only insert into the specified columns and will fill the unspecified columns with null values.

### Deleting from a Table:

The delete command has many uses. If you want to delete a specific record you can do that. If you want to delete all rows from a table, go for that too. Here is an example of a delete command that will delete within certain parameters:

    DELETE FROM "Table_name" WHERE "Col_name1"='Value_1"; 

Let us run through the paramters. "Table_name" as always is the name of the table you are accessing, and the second part "WHERE" is the conditions under which we are deleting from the table. This specific command is deleting any records where "Value1" is in the Column "Col_name1". When paired with PRIMARY KEYS this can be a very precise tool. When paired with records that have repeating values in certain columns, it can be very simple to purge many records.

A second version of the DELETE command is:

    DELETE FROM "Table_name"; 

What this version of the command does is delete all rows/records from the table while keeping the columns and general structure of the table intact. Use this command if you somehow mess up your table and just need a clean version that retains the column structure.

### Selecting from a Table:

Now that we know how to create, insert, and delete from a table, after a couple insertions we should have a full table. But with so many columns how can one filter down a large table into the specific bits they want to analyze? Enter stage left the SELECT command. What this command does is return a result-set of the table with only the columns specified in the command:

    SELECT "Col_name1", "Col_name2"
    FROM "Table_name"; 

This version of delete returns a result-set of only the columns "Col_name1" and "Col_name2" from the table "Table_name". If you desire, you can put an "*" instead of specifying column names to grab all of the columns in the table. When querying very large databases, it becomes significantly more efficient to only query the necessary columns. Grabbing more columns is a waste of resources.

#### WHERE Keyword
To read the values from a database, use the "select" command, with an optional "where" option to be able to specify what parameters you would like to search based on.
    
Let's say that we have a customer table with columns for name, city, and age. To retrieve all the information of the customers that live in Chicago, use:

    SELECT * FROM Customer
    WHERE city = 'Chicago';
    
There are a number of additional keywords that you can add to change the parameters of your search. For simplicity, assume all of the following commands start with:
    
    SELECT * FROM Customer
    
You can search for all customers that do NOT live in Chicago with the NOT keyword (or != comparison):

    WHERE NOT city = 'Chicago';

If you wanted to search based on multiple columns, you can simply chain them together with "and" or "or". If you wanted a set   of all customers in Chicago named Bob, you would do this:

    WHERE city = 'Chicago' AND name = 'Bob';

If you want all customers in Chicago and all customers named James, you would do this:

    WHERE city = 'Chicago' OR name = 'James';

You can also check for null elements in the table. Note that you could do the same thing to check for non-null entries by       using NOT NULL instead of NULL.

    WHERE city IS NULL;
    
The BETWEEN keyword filters out all entries that have a column value outside of a specified range. This works with integers as well as strings. To list all customers that are between 30 and 40 years old, use:

    WHERE age BETWEEN 30 AND 40;
    
When dealing with strings, you may wish to filter your table based on certain patterns in the string. This is accomplished with the LIKE keyword. The parameter after LIKE will be the string you want to find, but it can contain % or _ as well. The % sign allows for any string to be in its place, which can be any number of characters including the empty string. The _ allows for any single characters to take its place.

    WHERE name LIKE 'B%'; //Any name starting with B
    WHERE name LIKE ___; //Any 3 letter name

### Updating a Table:
With a table, you will eventually need to change or update the records inside of it. The Update function makes those two interactions very simple. It has a similar parameter structure to the other commands and looks like this:

    UPDATE “Table_name”
    SET “Col_name1” = “Value_1”, “Col_name2” = “Value_2”, “Col_name3” = “Value_3”
    WHERE “Col_name4” = “Value_4”;

The parameter “Table_name” is the table you would like to update a record from. The WHERE command decides what records you would like to update. The example above means that you are trying to alter records where the column “Col_name4” is equal to “Value_4”. If you use a column containing PRIMARY KEY values in the WHERE statement you can update the record corresponding to that PRIMARY KEY value. If not using a PRIMARY KEY column, you can update all records that have “Value_4” in the “Col_name4” column. The SET command overwrites the values of the records specified by WHERE in the specified columns “Col_name1” = “Value_1”, “Col_name2” = “Value_2”, and etc.

TIP: If you do not specify columns in the WHERE statement all columns will be updated. This can be a very useful tool or an annoying mistake.

### Dropping a Table:

So let’s say you messed up an entire table, or you just do not need a table anymore. Do I have the command for you. Its simply:

    DROP TABLE “Table_name”;

That’s it. Pretty self explanatory, drop the Table with the name “Table_name”. Wow!

### Altering a Table:

The ALTER table command is going to be very useful for fixing up a table. With this command you can ADD, DROP, or MODIFY columns from a table.

    ALTER “Table_name”
    ADD “Col_name1” “Data_type”;

The ADD command, simply adds a column to the table “Table_name” with name “Col_name1” which holds “Data_type” types.

    ALTER “Table_name”
    DROP “Col_name1”;

The DROP command simply deletes the “Col_name1” column from the table “Table_name”.

    ALTER “Table_name”
    ALTER COLUMN “Col_name1” “Data_type”;

And finally the ALTER COLUMN command alters the datatypes that column “Col_name1” in table “Table_name” holds to “Data_type”.

### Merging Tables:

Let's say that you have multiple tables that you would like to merge together. There is a command for this too, and this command is JOIN. There are multiple types of joins: 

INNER JOIN: This join merges records in tables that have records with matching values.

RIGHT JOIN: A RIGHT JOIN merges records from the 1st table (left table) that has matching values of the right table and merges those records with the right table.

LEFT JOIN: A LEFT JOIN merges records from the 2nd table (right table) that has matching values of the left table and merges those records with the left table.

FULL JOIN: A FULL JOIN is practically a LEFT and RIGHT JOIN together. A FULL JOIN merges all records. in both tables that matching values.

Here is a graphic to help visualize what the different types of JOINs entail.

![](join.png)


These are very useful commands and can make naming or typing errors from the past easily fixable.



# Database Basics:

## What is a Database?:

A database is a collection of tables and indices that stores all necessary information. Picture the database as a house, where the rooms in the house are tables. If you own a company that sells products to customers, you would most likely have a database containing all order and customer information, which would be contained in an order table and a customer table. The current database you are working in can be seen on the top left of your microsoft SQL window. It defaults to master, but you are able to create more. Whenever you create or manipulate tables, those changes are made in the database that you are working in. 

Here is a simple example of how tables can combine to form a database. Notice that each request will have to query the requestor table in order to obtain any of the data it holds.

![](PU5ND.png)

## Interacting with a Database:

You can create and delete a database with these commands. Then use all the commands for tables discussed previously to make the changes you want.

#### Create a database:
Just like creating a table.

    CREATE DATABASE databasename;
    
#### Deleting a database:
Just like deleting a table.

    DROP DATABASE databasename;
    
#### Speed up Queries:
SQL uses indexes to speed up accesses to data in the database. An index is not something that is visible to the user, it is just used behind the data to allow faster access to data in the specified columns. Whenever working with a large table with many entries or many columns, you should create an index to speed up accesses to frequently requested columns. You can create an index with:

    CREATE INDEX indexname
    ON tablename(column1, column2, ...);
    
The command to delete an index varies based on the specific version of SQL used, but this is the syntax for MS Access:

    DROP INDEX indexname ON tablename;
    
    
    
## Task at Hand:

Okay, that was a lot of information thrown your way, but now is the time to put your knowledge the test. At the beginning of this tutorial we included links at the top that will help you setup a local SQL environment, so go there if you have not already. After setting up your environment, first attempt to create a table and add some records to it. After head to this link for some sample SQL files so you do not have to about creating an entire table from scratch!

https://www.sample-videos.com/download-sample-sql.php

Try using all of the commands you read about above to get a good feel for how these commands work in practice. You will definitely want to cover SELECT, UPDATE, DELETE, and INSERT INTO. 


There are many more commands out there for SQL but are much more specific and niche in their uses, but you might run into a problem where these niche commands will do exactly what you want. 